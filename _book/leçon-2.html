<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.1 Leçon | SCI 1031 Visualisation et analyse de données spatiales sous R</title>
  <meta name="description" content="Ceci est une première ébauche de la conception du cours SCI 1031." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="3.1 Leçon | SCI 1031 Visualisation et analyse de données spatiales sous R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Ceci est une première ébauche de la conception du cours SCI 1031." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.1 Leçon | SCI 1031 Visualisation et analyse de données spatiales sous R" />
  
  <meta name="twitter:description" content="Ceci est une première ébauche de la conception du cours SCI 1031." />
  

<meta name="author" content="" />


<meta name="date" content="2020-04-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="vec.html"/>
<link rel="next" href="exercice-2.html"/>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Ébauche #1 du cours SCI 1031.</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenue!</a></li>
<li class="part"><span><b>I À propos du cours</b></span></li>
<li class="chapter" data-level="" data-path="présentation.html"><a href="présentation.html"><i class="fa fa-check"></i>Présentation</a><ul>
<li class="chapter" data-level="" data-path="objectifs.html"><a href="objectifs.html"><i class="fa fa-check"></i>Objectifs</a></li>
<li class="chapter" data-level="" data-path="fonctionnement-du-cours.html"><a href="fonctionnement-du-cours.html"><i class="fa fa-check"></i>Fonctionnement du cours</a></li>
<li class="chapter" data-level="" data-path="rétroaction.html"><a href="rétroaction.html"><i class="fa fa-check"></i>Rétroaction</a></li>
<li class="chapter" data-level="" data-path="travaux-notés.html"><a href="travaux-notés.html"><i class="fa fa-check"></i>Travaux notés</a></li>
<li class="chapter" data-level="" data-path="sources-de-données.html"><a href="sources-de-données.html"><i class="fa fa-check"></i>Sources de données</a></li>
<li class="chapter" data-level="" data-path="utilisation-de-r.html"><a href="utilisation-de-r.html"><i class="fa fa-check"></i>Utilisation de R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="feuille-de-route.html"><a href="feuille-de-route.html"><i class="fa fa-check"></i>Feuille de route</a></li>
<li class="chapter" data-level="" data-path="ressources-r.html"><a href="ressources-r.html"><i class="fa fa-check"></i>Ressources R</a><ul>
<li class="chapter" data-level="" data-path="guide-général-r.html"><a href="guide-général-r.html"><i class="fa fa-check"></i>Guide général R</a></li>
<li class="chapter" data-level="" data-path="les-libraries-r.html"><a href="les-libraries-r.html"><i class="fa fa-check"></i>Les libraries R</a></li>
<li class="chapter" data-level="" data-path="guide-r-markdown.html"><a href="guide-r-markdown.html"><i class="fa fa-check"></i>Guide R-Markdown</a></li>
<li class="chapter" data-level="" data-path="guide-shiny-app.html"><a href="guide-shiny-app.html"><i class="fa fa-check"></i>Guide shiny app</a></li>
<li class="chapter" data-level="" data-path="références-r.html"><a href="références-r.html"><i class="fa fa-check"></i>Références R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="données.html"><a href="données.html"><i class="fa fa-check"></i>Données</a><ul>
<li class="chapter" data-level="" data-path="données-utilisées-dans-le-cours.html"><a href="données-utilisées-dans-le-cours.html"><i class="fa fa-check"></i>Données utilisées dans le cours</a></li>
<li class="chapter" data-level="" data-path="autres-sources-de-données.html"><a href="autres-sources-de-données.html"><i class="fa fa-check"></i>Autres sources de données</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="travaux-notés-1.html"><a href="travaux-notés-1.html"><i class="fa fa-check"></i>Travaux notés</a><ul>
<li class="chapter" data-level="" data-path="travail-noté-1.html"><a href="travail-noté-1.html"><i class="fa fa-check"></i>Travail noté 1</a></li>
<li class="chapter" data-level="" data-path="travail-noté-2.html"><a href="travail-noté-2.html"><i class="fa fa-check"></i>Travail noté 2</a></li>
<li class="chapter" data-level="" data-path="travail-noté-3.html"><a href="travail-noté-3.html"><i class="fa fa-check"></i>Travail noté 3</a></li>
<li class="chapter" data-level="" data-path="travail-noté-4.html"><a href="travail-noté-4.html"><i class="fa fa-check"></i>Travail noté 4</a></li>
<li class="chapter" data-level="" data-path="examen.html"><a href="examen.html"><i class="fa fa-check"></i>Examen</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="références.html"><a href="références.html"><i class="fa fa-check"></i>Références</a></li>
<li class="chapter" data-level="" data-path="crédits.html"><a href="crédits.html"><i class="fa fa-check"></i>Crédits</a></li>
<li class="part"><span><b>II Apprentissage</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="leçon.html"><a href="leçon.html"><i class="fa fa-check"></i><b>1.1</b> Leçon</a><ul>
<li class="chapter" data-level="1.1.1" data-path="leçon.html"><a href="leçon.html#les-données-spatiales"><i class="fa fa-check"></i><b>1.1.1</b> Les données spatiales</a></li>
<li class="chapter" data-level="1.1.2" data-path="leçon.html"><a href="leçon.html#les-outils"><i class="fa fa-check"></i><b>1.1.2</b> Les outils</a></li>
<li class="chapter" data-level="1.1.3" data-path="leçon.html"><a href="leçon.html#lutilisation-de-r"><i class="fa fa-check"></i><b>1.1.3</b> L’utilisation de R</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="exercice.html"><a href="exercice.html"><i class="fa fa-check"></i><b>1.2</b> Exercice</a><ul>
<li class="chapter" data-level="1.2.1" data-path="exercice.html"><a href="exercice.html#mon-premier-r-markdown"><i class="fa fa-check"></i><b>1.2.1</b> Mon premier R-Markdown</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="base.html"><a href="base.html"><i class="fa fa-check"></i><b>2</b> La représentation spatiale</a><ul>
<li class="chapter" data-level="2.1" data-path="leçon-1.html"><a href="leçon-1.html"><i class="fa fa-check"></i><b>2.1</b> Leçon</a><ul>
<li class="chapter" data-level="2.1.1" data-path="leçon-1.html"><a href="leçon-1.html#les-concepts-de-base"><i class="fa fa-check"></i><b>2.1.1</b> Les concepts de base</a></li>
<li class="chapter" data-level="2.1.2" data-path="leçon-1.html"><a href="leçon-1.html#la-représentation-de-données-spatiales"><i class="fa fa-check"></i><b>2.1.2</b> La représentation de données spatiales</a></li>
<li class="chapter" data-level="2.1.3" data-path="leçon-1.html"><a href="leçon-1.html#les-systèmes-de-coordonnées-de-référence"><i class="fa fa-check"></i><b>2.1.3</b> Les systèmes de coordonnées de référence</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="exercice-1.html"><a href="exercice-1.html"><i class="fa fa-check"></i><b>2.2</b> Exercice</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="vec.html"><a href="vec.html"><i class="fa fa-check"></i><b>3</b> Les données vectorielles</a><ul>
<li class="chapter" data-level="3.1" data-path="leçon-2.html"><a href="leçon-2.html"><i class="fa fa-check"></i><b>3.1</b> Leçon</a><ul>
<li class="chapter" data-level="3.1.1" data-path="leçon-2.html"><a href="leçon-2.html#introduction-aux-données-vectorielles-sous-r"><i class="fa fa-check"></i><b>3.1.1</b> Introduction aux données vectorielles sous R</a></li>
<li class="chapter" data-level="3.1.2" data-path="leçon-2.html"><a href="leçon-2.html#visualisation-de-shapefiles-sous-r"><i class="fa fa-check"></i><b>3.1.2</b> Visualisation de shapefiles sous R</a></li>
<li class="chapter" data-level="3.1.3" data-path="leçon-2.html"><a href="leçon-2.html#reprojection-de-données-vectorielles-sous-r"><i class="fa fa-check"></i><b>3.1.3</b> Reprojection de données vectorielles sous R</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="exercice-2.html"><a href="exercice-2.html"><i class="fa fa-check"></i><b>3.2</b> Exercice</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mat.html"><a href="mat.html"><i class="fa fa-check"></i><b>4</b> Les données matricielles</a><ul>
<li class="chapter" data-level="4.1" data-path="leçon-3.html"><a href="leçon-3.html"><i class="fa fa-check"></i><b>4.1</b> Leçon</a><ul>
<li class="chapter" data-level="4.1.1" data-path="leçon-3.html"><a href="leçon-3.html#introduction-aux-données-matricielles-sous-r"><i class="fa fa-check"></i><b>4.1.1</b> Introduction aux données matricielles sous R</a></li>
<li class="chapter" data-level="4.1.2" data-path="leçon-3.html"><a href="leçon-3.html#visualisation-de-rasters-sous-r"><i class="fa fa-check"></i><b>4.1.2</b> Visualisation de rasters sous R</a></li>
<li class="chapter" data-level="4.1.3" data-path="leçon-3.html"><a href="leçon-3.html#reprojection-de-données-matricielles-sous-r"><i class="fa fa-check"></i><b>4.1.3</b> Reprojection de données matricielles sous R</a></li>
<li class="chapter" data-level="4.1.4" data-path="leçon-3.html"><a href="leçon-3.html#manipulation-de-rasters-multi-bande-sous-r"><i class="fa fa-check"></i><b>4.1.4</b> Manipulation de rasters multi-bande sous R</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="exercice-3.html"><a href="exercice-3.html"><i class="fa fa-check"></i><b>4.2</b> Exercice</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="carto.html"><a href="carto.html"><i class="fa fa-check"></i><b>5</b> La cartographie</a><ul>
<li class="chapter" data-level="5.1" data-path="leçon-4.html"><a href="leçon-4.html"><i class="fa fa-check"></i><b>5.1</b> Leçon</a><ul>
<li class="chapter" data-level="5.1.1" data-path="leçon-4.html"><a href="leçon-4.html#cartographie-dobjets-vectoriels"><i class="fa fa-check"></i><b>5.1.1</b> Cartographie d’objets vectoriels</a></li>
<li class="chapter" data-level="5.1.2" data-path="leçon-4.html"><a href="leçon-4.html#cartographie-dobjets-matriciels"><i class="fa fa-check"></i><b>5.1.2</b> Cartographie d’objets matriciels</a></li>
<li class="chapter" data-level="5.1.3" data-path="leçon-4.html"><a href="leçon-4.html#cartographie-en-ligne"><i class="fa fa-check"></i><b>5.1.3</b> Cartographie en ligne</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="exercice-4.html"><a href="exercice-4.html"><i class="fa fa-check"></i><b>5.2</b> Exercice</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="map-vec.html"><a href="map-vec.html"><i class="fa fa-check"></i><b>6</b> La manipulation de données vectorielles</a><ul>
<li class="chapter" data-level="6.1" data-path="leçon-5.html"><a href="leçon-5.html"><i class="fa fa-check"></i><b>6.1</b> Leçon</a><ul>
<li class="chapter" data-level="6.1.1" data-path="leçon-5.html"><a href="leçon-5.html#opérations-de-base"><i class="fa fa-check"></i><b>6.1.1</b> Opérations de base</a></li>
<li class="chapter" data-level="6.1.2" data-path="leçon-5.html"><a href="leçon-5.html#opération-sur-une-couche-vectorielle"><i class="fa fa-check"></i><b>6.1.2</b> Opération sur une couche vectorielle</a></li>
<li class="chapter" data-level="6.1.3" data-path="leçon-5.html"><a href="leçon-5.html#opération-sur-plusieurs-couches-vectorielles"><i class="fa fa-check"></i><b>6.1.3</b> Opération sur plusieurs couches vectorielles</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="exercice-5.html"><a href="exercice-5.html"><i class="fa fa-check"></i><b>6.2</b> Exercice</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="map-mat.html"><a href="map-mat.html"><i class="fa fa-check"></i><b>7</b> La manipulation de données matricielles</a><ul>
<li class="chapter" data-level="7.1" data-path="leçon-6.html"><a href="leçon-6.html"><i class="fa fa-check"></i><b>7.1</b> Leçon</a><ul>
<li class="chapter" data-level="7.1.1" data-path="leçon-6.html"><a href="leçon-6.html#opérations-de-base-1"><i class="fa fa-check"></i><b>7.1.1</b> Opérations de base</a></li>
<li class="chapter" data-level="7.1.2" data-path="leçon-6.html"><a href="leçon-6.html#opération-sur-un-raster"><i class="fa fa-check"></i><b>7.1.2</b> Opération sur un raster</a></li>
<li class="chapter" data-level="7.1.3" data-path="leçon-6.html"><a href="leçon-6.html#opération-sur-plusieurs-rasters"><i class="fa fa-check"></i><b>7.1.3</b> Opération sur plusieurs rasters</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="exercice-6.html"><a href="exercice-6.html"><i class="fa fa-check"></i><b>7.2</b> Exercice</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="spatiotemp.html"><a href="spatiotemp.html"><i class="fa fa-check"></i><b>8</b> Les données spatiotemporelles</a><ul>
<li class="chapter" data-level="8.1" data-path="leçon-7.html"><a href="leçon-7.html"><i class="fa fa-check"></i><b>8.1</b> Leçon</a><ul>
<li class="chapter" data-level="8.1.1" data-path="leçon-7.html"><a href="leçon-7.html#propriétés-des-données-spatiotemporelles"><i class="fa fa-check"></i><b>8.1.1</b> Propriétés des données spatiotemporelles</a></li>
<li class="chapter" data-level="8.1.2" data-path="leçon-7.html"><a href="leçon-7.html#introduction-à-la-librairie-r-spacetime"><i class="fa fa-check"></i><b>8.1.2</b> Introduction à la librairie R spacetime</a></li>
<li class="chapter" data-level="8.1.3" data-path="leçon-7.html"><a href="leçon-7.html#visualisation"><i class="fa fa-check"></i><b>8.1.3</b> Visualisation</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="exercice-7.html"><a href="exercice-7.html"><i class="fa fa-check"></i><b>8.2</b> Exercice</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="analyse.html"><a href="analyse.html"><i class="fa fa-check"></i><b>9</b> L’analyse de données spatiales</a><ul>
<li class="chapter" data-level="9.1" data-path="leçon-8.html"><a href="leçon-8.html"><i class="fa fa-check"></i><b>9.1</b> Leçon</a><ul>
<li class="chapter" data-level="9.1.1" data-path="leçon-8.html"><a href="leçon-8.html#distance"><i class="fa fa-check"></i><b>9.1.1</b> Distance</a></li>
<li class="chapter" data-level="9.1.2" data-path="leçon-8.html"><a href="leçon-8.html#configuration-spatiale"><i class="fa fa-check"></i><b>9.1.2</b> Configuration spatiale</a></li>
<li class="chapter" data-level="9.1.3" data-path="leçon-8.html"><a href="leçon-8.html#autocorrélation-spatiale"><i class="fa fa-check"></i><b>9.1.3</b> Autocorrélation spatiale</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="exercice-8.html"><a href="exercice-8.html"><i class="fa fa-check"></i><b>9.2</b> Exercice</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">SCI 1031 Visualisation et analyse de données spatiales sous R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="leçon-2" class="section level2">
<h2><span class="header-section-number">3.1</span> Leçon</h2>
<p>L’ensemble du matériel disponible dans ce module est adapté du cours <em>Introduction to Geospatial Raster and Vector Data with R</em><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> de l’organisme <a href="https://datacarpentry.org/">Data Carpentry</a>. Data Carpentry développe et offre des formations variées et spécialisées sur le traitement et l’analyse de données. Ses formations s’adressent surtout aux chercheuses et chercheurs scientifiques, mais peuvent être consultées par quiconque car leur matériel est libre d’accès. N’hésitez donc pas à y jeter un coup d’œil.</p>
<p>Dans le cadre de cette leçon, nous allons explorer des données vectorielles relatives au réseau de pistes cyclables de la ville de Montréal et aux accidents routiers impliquant des bicyclettes.
Téléchargez les données en cliquant sur ce <a href="https://github.com/elisefilotas/Donnees_spatiales/blob/master/Montreal_Velo.zip">lien</a>. Sauvegardez le dossier compressé (<code>zip</code>) dans votre répertoire de travail ‘Donnees’ pour ce module, et dézippez-le. Le dossier Montreal_Velo comprend trois sous-dossiers:</p>
<ul>
<li>accidents,</li>
<li>pistes, et</li>
<li>terre.</li>
</ul>
<div id="introduction-aux-données-vectorielles-sous-r" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Introduction aux données vectorielles sous R</h3>
<div id="lire-un-shapefile-et-interpréter-sa-géométrie" class="section level4 unnumbered">
<h4>Lire un shapefile et interpréter sa géométrie</h4>
<p>Pour lire des données vectorielles contenues dans un fichier shapefile, nous allons utiliser la librairie <code>sf</code>. Notez que la librairie <code>rgdal</code> se charge automatiquement lorsque <code>sf</code> se charge.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="leçon-2.html#cb1-1"></a><span class="kw">library</span>(sf)</span></code></pre></div>
<p>Les shapefiles que nous allons lire sont les suivants :</p>
<ul>
<li>Des données vectorielles de type polygone représentant la frontière de notre zone d’étude, ici, l’île de Montréal.</li>
<li>Des données vectorielles de type ligne représentant les pistes cyclables sur l’île de Montréal, et</li>
<li>Des données vectorielles de type point représentant la position d’accidents impliquant des bicyclettes.</li>
</ul>
<p>Les premières données vectorielles que nous allons ouvrir contiennent les limites terrestres de l’île de Montréal. Pour lire ces données nous utiliserons la fonction <code>st_read()</code> de la librarie <code>sf</code>. Pour utiliser <code>st_read()</code> nous devons spécifier le chemin menant au fichier shapefile à lire.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="leçon-2.html#cb2-1"></a>chemin&lt;-<span class="st">&quot;D:/votrechemin/SCI1031/Module3/Donnees/&quot;</span></span>
<span id="cb2-2"><a href="leçon-2.html#cb2-2"></a>nom_du_fichier &lt;-<span class="st"> </span><span class="kw">paste</span>(chemin, <span class="st">&quot;/Montreal_Velo/terre/terre_shp.shp&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb2-3"><a href="leçon-2.html#cb2-3"></a>limites_terrestres &lt;-<span class="st"> </span><span class="kw">st_read</span>(nom_du_fichier)</span></code></pre></div>
<pre><code>Reading layer `LIMADMIN&#39; from data source `/home/kevcaz/Github/Tutorials/sci1031/Module3/data/LIMADMIN.shp&#39; using driver `ESRI Shapefile&#39;
Simple feature collection with 34 features and 9 fields
geometry type:  MULTIPOLYGON
dimension:      XY
bbox:           xmin: -74 ymin: 45.39 xmax: -73.47 ymax: 45.71
epsg (SRID):    4326
proj4string:    +proj=longlat +datum=WGS84 +no_defs</code></pre>
<p>La fonction <code>st_read()</code> vous permet d’ores et déjà d’obtenir certaines informations sur la structure des données vectorielles que vous venez de lire: le type de géométrie (<code>geometry type</code>), la dimension des données (<code>dimension</code>), l’étendue spatiale des données (<code>bbox</code>), et les informations relatives au système de coordonnées de référence, le SPSG (<code>epsg (SRID)</code>) et la projection (<code>proj4string</code>). Nous explorerons ces propriétés en détails plus bas.</p>
<p>Nous allons maintenant lire les données vectorielles de type ligne, en utilisant encore la fonction <code>st_read()</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="leçon-2.html#cb4-1"></a>chemin &lt;-<span class="st">&quot;D:/votrechemin/SCI1031/Module3/Donnees/&quot;</span></span>
<span id="cb4-2"><a href="leçon-2.html#cb4-2"></a>nom_du_fichier&lt;-<span class="st"> </span><span class="kw">paste</span>(chemin, <span class="st">&quot;/Montreal_Velo/pistes/pistes_cyclables_type.shp&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb4-3"><a href="leçon-2.html#cb4-3"></a>pistes_cyclables &lt;-<span class="st"> </span><span class="kw">st_read</span>(nom_du_fichier)</span></code></pre></div>
<pre><code>Reading layer `LIMADMIN&#39; from data source `/home/kevcaz/Github/Tutorials/sci1031/Module3/data/LIMADMIN.shp&#39; using driver `ESRI Shapefile&#39;
Simple feature collection with 34 features and 9 fields
geometry type:  MULTIPOLYGON
dimension:      XY
bbox:           xmin: -74 ymin: 45.39 xmax: -73.47 ymax: 45.71
epsg (SRID):    4326
proj4string:    +proj=longlat +datum=WGS84 +no_defs</code></pre>
<p>Finalement, nous allons lire les données vectorielles de type point, en utilisant toujours la fonction <code>st_read()</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="leçon-2.html#cb6-1"></a>chemin&lt;-<span class="st">&quot;D:/votrechemin/SCI1031/Module3/Donnees/&quot;</span></span>
<span id="cb6-2"><a href="leçon-2.html#cb6-2"></a>nom_du_fichier&lt;-<span class="st"> </span><span class="kw">paste</span>(chemin, <span class="st">&quot;/Montreal_Velo/accidents/accidents2018_Mtl_velo.shp&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb6-3"><a href="leçon-2.html#cb6-3"></a>pistes_cyclables &lt;-<span class="st"> </span><span class="kw">st_read</span>(nom_du_fichier)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="leçon-2.html#cb7-1"></a><span class="co"># nom_du_fichier&lt;- paste(module, &quot;/Montreal_Velo/accidents/accidents2018_Mtl_velo.shp&quot;, sep = &quot;&quot;)</span></span>
<span id="cb7-2"><a href="leçon-2.html#cb7-2"></a><span class="co"># accidents_velo &lt;- st_read(nom_du_fichier)</span></span>
<span id="cb7-3"><a href="leçon-2.html#cb7-3"></a>accidents_velo &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;Module3/data/LIMADMIN.shp&quot;</span>)</span></code></pre></div>
<pre><code>Reading layer `LIMADMIN&#39; from data source `/home/kevcaz/Github/Tutorials/sci1031/Module3/data/LIMADMIN.shp&#39; using driver `ESRI Shapefile&#39;
Simple feature collection with 34 features and 9 fields
geometry type:  MULTIPOLYGON
dimension:      XY
bbox:           xmin: -74 ymin: 45.39 xmax: -73.47 ymax: 45.71
epsg (SRID):    4326
proj4string:    +proj=longlat +datum=WGS84 +no_defs</code></pre>
<p>Remarquez que le type de géométrie (<code>geometry type</code>) diffère pour les trois classes de données lues.</p>
<p>####Explorer les métadonnées d’un shapefile {-}
Les informations contenues dans un shapefile sont appelées des métadonnées. Nous sommes particulièrement intéressées aux métadonnées géospatiales.</p>
<p>Les métadonnées fondamentales d’un shapefile sont :</p>
<ol style="list-style-type: decimal">
<li>Type de géométrie : le type de classes des données vectorielles téléchargées.</li>
<li>La projection : le système de coordonnées de référence utilisé pour représenter les données.</li>
<li>L’étendue spatiale : la superficie géographique couvrant les données vectorielles.</li>
</ol>
<p>Nous pouvons explorer chacune de ces métadonnées en utilisant des fonctions de la librairie <code>sf</code>. Le type de géométrie est obtenu par la fonction <code>st_geometry_type()</code>. Par exemple, pour les limites terrestres de la ville de Montréal, nous avons :</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="leçon-2.html#cb9-1"></a><span class="kw">st_geometry_type</span>(limites_terrestres)</span></code></pre></div>
<pre><code> [1] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [4] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [7] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[10] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[13] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[16] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[19] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[22] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[25] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[28] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[31] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[34] MULTIPOLYGON
18 Levels: GEOMETRY POINT LINESTRING ... TRIANGLE</code></pre>
<p>Nous avons ainsi la confirmation que ces données vectorielles correspondent des polygones (plus exactement, 72 polygones). Les 18 niveaux donnés en dessous constituent une liste des classes possibles de géométrie.</p>
<p>En comparaison, pour les données de type ligne et de type point nous obtenons plutôt :</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="leçon-2.html#cb11-1"></a><span class="kw">st_geometry_type</span>(pistes_cyclables)</span></code></pre></div>
<pre><code> [1] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [4] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
...
[34] MULTIPOLYGON
18 Levels: GEOMETRY POINT LINESTRING ... TRIANGLE</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="leçon-2.html#cb13-1"></a><span class="kw">st_geometry_type</span>(accidents_velo)</span></code></pre></div>
<pre><code> [1] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [4] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
...
[34] MULTIPOLYGON
18 Levels: GEOMETRY POINT LINESTRING ... TRIANGLE</code></pre>
<p>Vous remarquez alors que les pistes cyclables sont composées de nombreuses multilignes. Une multiligne étant elle-même un ensemble de lignes.
Quant aux accidents de vélo, on en compte 796 en 2018.</p>
<p>Vérifions maintenant la projection des shapefiles en utilisant la fonction <code>st_crs()</code> de la librarie <code>sf</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="leçon-2.html#cb15-1"></a><span class="kw">st_crs</span>(limites_terrestres)</span></code></pre></div>
<pre><code>Coordinate Reference System:
  EPSG: 4326 
  proj4string: &quot;+proj=longlat +datum=WGS84 +no_defs&quot;</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="leçon-2.html#cb17-1"></a><span class="kw">st_crs</span>(pistes_cyclables)</span></code></pre></div>
<pre><code>Coordinate Reference System:
  EPSG: 4326 
  proj4string: &quot;+proj=longlat +datum=WGS84 +no_defs&quot;</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="leçon-2.html#cb19-1"></a><span class="kw">st_crs</span>(accidents_velo)</span></code></pre></div>
<pre><code>Coordinate Reference System:
  EPSG: 4326 
  proj4string: &quot;+proj=longlat +datum=WGS84 +no_defs&quot;</code></pre>
<p>Les données de tous les shapefiles sont dans la projection de Mercator transverse (<code>tmerc</code>) et utilisent le Système de référence géodésique nord-américan de 1983 (<code>NAD83</code>). Il n’y a pas de EPSG assigné à ces données. Connaitre le SCR est essentiel pour interpréter l’étendue spatiale des objets spatiaux puisque celui-ci précise, en quelque sorte, les unités de mesure.</p>
<p>Pour connaître l’étendue spatiale des shapefiles, nous utilisons la fonction <code>st_bbox()</code> de la librairie <code>sf</code> :</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="leçon-2.html#cb21-1"></a><span class="kw">st_bbox</span>(limites_terrestres)</span></code></pre></div>
<pre><code>  xmin   ymin   xmax   ymax 
-74.00  45.39 -73.47  45.71 </code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="leçon-2.html#cb23-1"></a><span class="kw">st_bbox</span>(pistes_cyclables)</span></code></pre></div>
<pre><code>  xmin   ymin   xmax   ymax 
-74.00  45.39 -73.47  45.71 </code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="leçon-2.html#cb25-1"></a><span class="kw">st_bbox</span>(accidents_velo)</span></code></pre></div>
<pre><code>  xmin   ymin   xmax   ymax 
-74.00  45.39 -73.47  45.71 </code></pre>
<p>L’étendue spatiale d’un shapefile ou d’un objet spatial dans <code>R</code> représente les limites géographiques des données, ou la localisation des données les plus au sud, nord, est et ouest.</p>
<p>ICI BESOIN D’UNE FIGURE COMME CELLE DE NEON</p>
<p>Finalement, nous pouvons visualiser toutes les métadonnées et les attributs d’un shapefile simplement en écrivant son nom dans la console <code>R</code>:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="leçon-2.html#cb27-1"></a>limites_terrestres</span></code></pre></div>
<pre><code>Simple feature collection with 34 features and 9 fields
geometry type:  MULTIPOLYGON
dimension:      XY
bbox:           xmin: -74 ymin: 45.39 xmax: -73.47 ymax: 45.71
epsg (SRID):    4326
proj4string:    +proj=longlat +datum=WGS84 +no_defs
First 10 features:
   MUNID CODEID CODEMAMROT
1  66023     11      REM05
2  66023     22      REM17
3  66023     62      66072
4  66023      9      REM19
5  66023      5      REM21
6  66023     54      66062
7  66023     63      REM20
8  66023     57      REM33
9  66023     28      REM27
10 66023     51      66087
                                        NOM
1                                 Outremont
2                                   LaSalle
3                                Mont-Royal
4                               Ville-Marie
5                     Le Plateau-Mont-Royal
6                                 Hampstead
7                              Le Sud-Ouest
8  Rivière-des-Prairies-Pointe-aux-Trembles
9                                   Lachine
10                                   Dorval
             TYPE ABREV NUM     AIRE PERIM
1  Arrondissement    OM   5  3813356 10837
2  Arrondissement    LS  18 25197268 25260
3      Ville liée    MR   2  7445560 18314
4  Arrondissement    VM  20 21500632 26586
5  Arrondissement    PM  22  8151665 13158
6      Ville liée    HS  10  1768055  5876
7  Arrondissement    SO  21 18144269 29633
8  Arrondissement    RP  19 50047004 38573
9  Arrondissement    LC  17 23127786 25400
10     Ville liée    DV   1 28156150 32358
                         geometry
1  MULTIPOLYGON (((-73.62 45.5...
2  MULTIPOLYGON (((-73.67 45.4...
3  MULTIPOLYGON (((-73.65 45.5...
4  MULTIPOLYGON (((-73.53 45.5...
5  MULTIPOLYGON (((-73.56 45.5...
6  MULTIPOLYGON (((-73.66 45.4...
7  MULTIPOLYGON (((-73.63 45.4...
8  MULTIPOLYGON (((-73.62 45.6...
9  MULTIPOLYGON (((-73.72 45.4...
10 MULTIPOLYGON (((-73.79 45.4...</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="leçon-2.html#cb29-1"></a>pistes_cyclables</span></code></pre></div>
<pre><code>Simple feature collection with 34 features and 10 fields
geometry type:  MULTIPOLYGON
dimension:      XY
bbox:           xmin: -74 ymin: 45.39 xmax: -73.47 ymax: 45.71
epsg (SRID):    4326
proj4string:    +proj=longlat +datum=WGS84 +no_defs
First 10 features:
   MUNID CODEID CODEMAMROT
1  66023     11      REM05
2  66023     22      REM17
3  66023     62      66072
4  66023      9      REM19
5  66023      5      REM21
6  66023     54      66062
7  66023     63      REM20
8  66023     57      REM33
9  66023     28      REM27
10 66023     51      66087
                                        NOM
1                                 Outremont
2                                   LaSalle
3                                Mont-Royal
4                               Ville-Marie
5                     Le Plateau-Mont-Royal
6                                 Hampstead
7                              Le Sud-Ouest
8  Rivière-des-Prairies-Pointe-aux-Trembles
9                                   Lachine
10                                   Dorval
             TYPE ABREV NUM     AIRE PERIM
1  Arrondissement    OM   5  3813356 10837
2  Arrondissement    LS  18 25197268 25260
3      Ville liée    MR   2  7445560 18314
4  Arrondissement    VM  20 21500632 26586
5  Arrondissement    PM  22  8151665 13158
6      Ville liée    HS  10  1768055  5876
7  Arrondissement    SO  21 18144269 29633
8  Arrondissement    RP  19 50047004 38573
9  Arrondissement    LC  17 23127786 25400
10     Ville liée    DV   1 28156150 32358
                         geometry TYPE_VOIE
1  MULTIPOLYGON (((-73.62 45.5...         1
2  MULTIPOLYGON (((-73.67 45.4...         2
3  MULTIPOLYGON (((-73.65 45.5...         3
4  MULTIPOLYGON (((-73.53 45.5...         4
5  MULTIPOLYGON (((-73.56 45.5...         5
6  MULTIPOLYGON (((-73.66 45.4...         1
7  MULTIPOLYGON (((-73.63 45.4...         2
8  MULTIPOLYGON (((-73.62 45.6...         3
9  MULTIPOLYGON (((-73.72 45.4...         4
10 MULTIPOLYGON (((-73.79 45.4...         5</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="leçon-2.html#cb31-1"></a>accidents_velo</span></code></pre></div>
<pre><code>Simple feature collection with 34 features and 9 fields
geometry type:  MULTIPOLYGON
dimension:      XY
bbox:           xmin: -74 ymin: 45.39 xmax: -73.47 ymax: 45.71
epsg (SRID):    4326
proj4string:    +proj=longlat +datum=WGS84 +no_defs
First 10 features:
   MUNID CODEID CODEMAMROT
1  66023     11      REM05
2  66023     22      REM17
3  66023     62      66072
4  66023      9      REM19
5  66023      5      REM21
6  66023     54      66062
7  66023     63      REM20
8  66023     57      REM33
9  66023     28      REM27
10 66023     51      66087
                                        NOM
1                                 Outremont
2                                   LaSalle
3                                Mont-Royal
4                               Ville-Marie
5                     Le Plateau-Mont-Royal
6                                 Hampstead
7                              Le Sud-Ouest
8  Rivière-des-Prairies-Pointe-aux-Trembles
9                                   Lachine
10                                   Dorval
             TYPE ABREV NUM     AIRE PERIM
1  Arrondissement    OM   5  3813356 10837
2  Arrondissement    LS  18 25197268 25260
3      Ville liée    MR   2  7445560 18314
4  Arrondissement    VM  20 21500632 26586
5  Arrondissement    PM  22  8151665 13158
6      Ville liée    HS  10  1768055  5876
7  Arrondissement    SO  21 18144269 29633
8  Arrondissement    RP  19 50047004 38573
9  Arrondissement    LC  17 23127786 25400
10     Ville liée    DV   1 28156150 32358
                         geometry
1  MULTIPOLYGON (((-73.62 45.5...
2  MULTIPOLYGON (((-73.67 45.4...
3  MULTIPOLYGON (((-73.65 45.5...
4  MULTIPOLYGON (((-73.53 45.5...
5  MULTIPOLYGON (((-73.56 45.5...
6  MULTIPOLYGON (((-73.66 45.4...
7  MULTIPOLYGON (((-73.63 45.4...
8  MULTIPOLYGON (((-73.62 45.6...
9  MULTIPOLYGON (((-73.72 45.4...
10 MULTIPOLYGON (((-73.79 45.4...</code></pre>
</div>
</div>
<div id="visualisation-de-shapefiles-sous-r" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Visualisation de shapefiles sous R</h3>
<div id="visualiser-des-données-vectorielles" class="section level4 unnumbered">
<h4>Visualiser des données vectorielles</h4>
<p>Nous allons maintenant apprendre à visualer des données shapefile en utilisant la fonction <code>ggplot()</code> de la librairie <code>ggplot2</code>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="leçon-2.html#cb33-1"></a><span class="kw">library</span>(ggplot2)</span></code></pre></div>
<p>Dans un premier temps, visualisons les limites terrestres de l’île de Montréal (Fig <a href="leçon-2.html#fig:plot-terre">3.1</a>).</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="leçon-2.html#cb34-1"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb34-2"><a href="leçon-2.html#cb34-2"></a><span class="kw">geom_sf</span>(<span class="dt">data =</span> limites_terrestres, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb34-3"><a href="leçon-2.html#cb34-3"></a><span class="kw">ggtitle</span>(<span class="st">&quot;Limites terrestres de l&#39;île de Montréal&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot-terre"></span>
<img src="Cours_SpatialR_files/figure-html/plot-terre-1.svg" alt="Limites terrestres de l'île de Montréal" width="720" />
<p class="caption">
Figure 3.1: Limites terrestres de l’île de Montréal
</p>
</div>
<p>La fonction <code>geom_sf()</code> permet de faire des représentations simples d’objets vectoriels de différentes géométries (points, lignes ou polygones).
Cette fonction peut prendre plusieurs arguments<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>. Les arguments utilisés ici sont les données, la taille du trait avec laquelle on illustre l’objet, la couleur du trait, et la couleur de la surface délimitée par le trait. La fonction ggtitle permet d’ajouter un titre à la figure générée.
Remarquez que chaque fonction est écrite sur sa propre ligne, pour faciliter la lecture des lignes de commande, et que chaque fonction qui s’ajoute à <code>ggplot()</code> est précédée par le signe plus <code>+</code>.</p>
<p>Dans un deuxième temps, visualisons les pistes cyclables (Fig <a href="leçon-2.html#fig:plot-velo">3.2</a>).</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="leçon-2.html#cb35-1"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb35-2"><a href="leçon-2.html#cb35-2"></a><span class="kw">geom_sf</span>(<span class="dt">data =</span> pistes_cyclables, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;darkgreen&quot;</span>) <span class="op">+</span></span>
<span id="cb35-3"><a href="leçon-2.html#cb35-3"></a><span class="kw">ggtitle</span>(<span class="st">&quot;Pistes cyclables sur l&#39;île de Montréal&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot-velo"></span>
<img src="Cours_SpatialR_files/figure-html/plot-velo-1.svg" alt="Pistes cyclables sur l'île de Montréal" width="720" />
<p class="caption">
Figure 3.2: Pistes cyclables sur l’île de Montréal
</p>
</div>
<p>Pour visualiser des lignes, nous n’avons pas besoin de définir l’argument <code>fill</code>. Vous remarquerez que les lignes, cette fois, sont vertes foncées (<code>darkgreen</code>).</p>
<p>Il existe 657 couleurs prédéfinies dans <code>R</code>. Taper la commande <code>colors()</code> dans votre console <code>R</code> pour voir afficher le nom des couleurs. Celles-sont sont listées par ordre alphabétique sauf pour la première couleur, qui est le blanc (<code>white</code>). Ainsi, vous pouvez utiliser une couleur en assignant son nom ou son numéro. Pour produire la figure précédente, <code>color = "darkgreen"</code> aurait pu être remplacé par
<code>color = colors()[81]</code>. Essayez pour voir.</p>
<p>Les couleurs peuvent aussi être définies selon leur composition en rouge, vert et bleu sur un intervalle allant de 0 à 255 - ce qu’on nomme le vecteur RGB (red, green, blue). Par exemple, la couleur jaune est représentée par le vecteur RGB (255, 255, 0). La couleur verte foncée, utilisée précédemment, est, quant à elle, représentée par le vecteur RGB (0, 100, 0). Les couleurs peuvent aussi être exprimée selon le système de notation <a href="https://fr.wikipedia.org/wiki/Syst%C3%A8me_hexad%C3%A9cimal">hexadécimal</a>. La fonction ‘rgb’ permet de traduire un vecteur de couleur RGB en notation hexadécimal. Ainsi, pour produire la figure précédente, nous aurions définir le vecteur <code>vert_fonce = rgb(0, 100, 0, maxColorValue=255)</code>, et remplacé <code>color = "darkgreen"</code> par <code>color = vert_fonce</code>. Essayez pour voir.</p>
<p>Pour en apprendre davantage sur les couleurs dans <code>R</code>, vous êtes invité à consulter le site <a href="https://github.com/EarlGlynn/colorchart/wiki/Color-Chart-in-R">Earl Glynn</a> et à conserver dans vos notes son <a href="Module3/3_TableauCouleurs.pdf">tableau synthèse des couleurs</a> dans <code>R</code>.</p>
<p>Finalement, visualisons les accidents de la route impliquant des bicyclettes (Fig <a href="leçon-2.html#fig:plot-accidents">3.3</a>).</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="leçon-2.html#cb36-1"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb36-2"><a href="leçon-2.html#cb36-2"></a><span class="kw">geom_sf</span>(<span class="dt">data =</span> accidents_velo, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">cex =</span> <span class="fl">1.25</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb36-3"><a href="leçon-2.html#cb36-3"></a><span class="kw">ggtitle</span>(<span class="st">&quot;Accidents de la route avec cyclistes sur l&#39;île de Montréal&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot-accidents"></span>
<img src="Cours_SpatialR_files/figure-html/plot-accidents-1.svg" alt="Accidents de la route avec cyclistes sur l'île de Montréal" width="720" />
<p class="caption">
Figure 3.3: Accidents de la route avec cyclistes sur l’île de Montréal
</p>
</div>
<p>Le symbole utilisé pour illustrer la position des accidents est défini par l’argument <code>pch = 19</code>. Il existe 25 formats de points différents prédéfinis dans <code>R</code>. Les voici:</p>
<div class="figure" style="text-align: center"><span id="fig:plot-symbols"></span>
<img src="Module3/3_symbolesR.png" alt="Symboles disponibles" width="50%" />
<p class="caption">
Figure 3.4: Symboles disponibles
</p>
</div>
<p>L’argument <code>cex</code>, quant à lui, indique le facteur par lequel la taille du symbole sera augmentée ou réduite par rapport à 1, la valeur par défaut. Par exemple, ‘cex = 1.5’ indique que le symbole sera 50% plus grand, alors que 0.5 indique que le symbole sera 50% plus petit.</p>
<p>Ainsi, nous pouvons changer les valeurs de ces arguments et représenter les accidents de vélo par des triangles oranges (Fig <a href="leçon-2.html#fig:plot-accidents2">3.5</a>).</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="leçon-2.html#cb37-1"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb37-2"><a href="leçon-2.html#cb37-2"></a><span class="kw">geom_sf</span>(<span class="dt">data =</span> accidents_velo, <span class="dt">pch =</span> <span class="dv">24</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;orange&quot;</span>) <span class="op">+</span></span>
<span id="cb37-3"><a href="leçon-2.html#cb37-3"></a><span class="kw">ggtitle</span>(<span class="st">&quot;Accidents de la route avec cyclistes sur l&#39;île de Montréal&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot-accidents2"></span>
<img src="Cours_SpatialR_files/figure-html/plot-accidents2-1.svg" alt="Symbole et couleur différents pour illustrer les accidents de la route avec cyclistes sur l'île de Montréal" width="720" />
<p class="caption">
Figure 3.5: Symbole et couleur différents pour illustrer les accidents de la route avec cyclistes sur l’île de Montréal
</p>
</div>
</div>
<div id="visualiser-des-données-vectorielles-par-attribut" class="section level4 unnumbered">
<h4>Visualiser des données vectorielles par attribut</h4>
<p>Lorsque nous avons affiché les métadonnées du shapefile <code>pistes_cyclables</code>, vous avez peut-être observé que ce dernier comprenait l’attribut <code>TYPE_VOIE</code> qui caractérise le type de pistes cyclables de chaque multiligne. Affichez les métadonnées à nouveau:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="leçon-2.html#cb38-1"></a>pistes_cyclables</span></code></pre></div>
<pre><code>Simple feature collection with 34 features and 10 fields
geometry type:  MULTIPOLYGON
dimension:      XY
bbox:           xmin: -74 ymin: 45.39 xmax: -73.47 ymax: 45.71
epsg (SRID):    4326
proj4string:    +proj=longlat +datum=WGS84 +no_defs
First 10 features:
   MUNID CODEID CODEMAMROT
1  66023     11      REM05
2  66023     22      REM17
3  66023     62      66072
4  66023      9      REM19
5  66023      5      REM21
6  66023     54      66062
7  66023     63      REM20
8  66023     57      REM33
9  66023     28      REM27
10 66023     51      66087
                                        NOM
1                                 Outremont
2                                   LaSalle
3                                Mont-Royal
4                               Ville-Marie
5                     Le Plateau-Mont-Royal
6                                 Hampstead
7                              Le Sud-Ouest
8  Rivière-des-Prairies-Pointe-aux-Trembles
9                                   Lachine
10                                   Dorval
             TYPE ABREV NUM     AIRE PERIM
1  Arrondissement    OM   5  3813356 10837
2  Arrondissement    LS  18 25197268 25260
3      Ville liée    MR   2  7445560 18314
4  Arrondissement    VM  20 21500632 26586
5  Arrondissement    PM  22  8151665 13158
6      Ville liée    HS  10  1768055  5876
7  Arrondissement    SO  21 18144269 29633
8  Arrondissement    RP  19 50047004 38573
9  Arrondissement    LC  17 23127786 25400
10     Ville liée    DV   1 28156150 32358
                         geometry TYPE_VOIE
1  MULTIPOLYGON (((-73.62 45.5...         1
2  MULTIPOLYGON (((-73.67 45.4...         2
3  MULTIPOLYGON (((-73.65 45.5...         3
4  MULTIPOLYGON (((-73.53 45.5...         4
5  MULTIPOLYGON (((-73.56 45.5...         5
6  MULTIPOLYGON (((-73.66 45.4...         1
7  MULTIPOLYGON (((-73.63 45.4...         2
8  MULTIPOLYGON (((-73.62 45.6...         3
9  MULTIPOLYGON (((-73.72 45.4...         4
10 MULTIPOLYGON (((-73.79 45.4...         5</code></pre>
<p>Utilisons la fonction <code>levels</code> pour connaître ces types de voie cyclables. La fonction <code>levels</code> donne les différentes valeurs que peuvent prendre un attribut.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="leçon-2.html#cb40-1"></a><span class="kw">levels</span>(pistes_cyclables<span class="op">$</span>TYPE_VOIE)</span></code></pre></div>
<pre><code>NULL</code></pre>
<p>Si vous ne connaissez pas la distinction entre ces types d’aménagement cyclable, consulter ce <a href="Module3/3_Amenagement3Cyclable3Mtl.pdf">document sommaire</a> de la <em>Ville de Montréal</em><a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<p>Nous voulons maintenant représenter les données vectorielles associées aux pistes cyclables de type <code>"Bande cyclable"</code>. Pour représenter une valeur précise d’un attribut, nous utiliserons la fonction <code>filter</code> de la librarie <code>dplyr</code>. Commençons par charger cette librairie.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="leçon-2.html#cb42-1"></a><span class="kw">library</span>(dplyr)</span></code></pre></div>
<p>Utilisons la fonction <code>filter</code> qui permet de filtrer l’ensemble des valeurs de l’attribut <code>TYPE_VOIE</code>, pour ne retenir que les données dont la valeur est identique (ce qui s’exprime par l’opération <code>==</code>) à ‘“Bande cyclable”’. Nous nommerons ce sous-ensemble de données <code>Bande</code>.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="leçon-2.html#cb43-1"></a>Bande &lt;-pistes_cyclables <span class="op">%&gt;%</span></span>
<span id="cb43-2"><a href="leçon-2.html#cb43-2"></a><span class="st">  </span><span class="kw">filter</span>(TYPE_VOIE <span class="op">==</span><span class="st">&quot;Bande cyclable&quot;</span>)</span></code></pre></div>
<p>Nous représentons ce sous-ensemble de données de la même manière que pour l’ensemble complet (Fig <a href="leçon-2.html#fig:plot-velo">3.2</a>).</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="leçon-2.html#cb44-1"></a><span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb44-2"><a href="leçon-2.html#cb44-2"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> Bande,  <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;darkgreen&quot;</span>)<span class="op">+</span></span>
<span id="cb44-3"><a href="leçon-2.html#cb44-3"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Pistes cyclables sur l&#39;île de Montréal&quot;</span>, <span class="dt">subtitle =</span> <span class="st">&quot;Bande cyclable&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot-voie3"></span>
<img src="Cours_SpatialR_files/figure-html/plot-voie3-1.svg" alt="Bandes cyclables sur l'île de Montréal" width="720" />
<p class="caption">
Figure 3.6: Bandes cyclables sur l’île de Montréal
</p>
</div>
<p>Nous voulons maintenant représenter les six types de voie cyclable par six couleurs différentes. Créons d’abord un vecteur de six couleurs, qu’on appelle une palette de couleurs.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="leçon-2.html#cb45-1"></a>couleurs_voie&lt;-<span class="kw">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;turquoise&quot;</span>, <span class="st">&quot;yellow&quot;</span>,<span class="st">&quot;darkblue&quot;</span>,<span class="st">&quot;violet&quot;</span>,<span class="st">&quot;orange&quot;</span>)</span></code></pre></div>
<p>Nous pouvons demander à <code>ggplot</code> d’utiliser ces couleurs pour illustrer les différents types de voie cyclable (Fig <a href="leçon-2.html#fig:plot-voie5">3.7</a>).</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="leçon-2.html#cb46-1"></a><span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb46-2"><a href="leçon-2.html#cb46-2"></a><span class="st">  </span><span class="co"># geom_sf(data = pistes_cyclables,  aes(color = TYPE_VOIE))+</span></span>
<span id="cb46-3"><a href="leçon-2.html#cb46-3"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> couleurs_voie)<span class="op">+</span></span>
<span id="cb46-4"><a href="leçon-2.html#cb46-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">color =</span> <span class="st">&#39;Types de voie&#39;</span>)<span class="op">+</span></span>
<span id="cb46-5"><a href="leçon-2.html#cb46-5"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Pistes cyclables sur l&#39;île de Montréal&quot;</span>, <span class="dt">subtitle =</span> <span class="st">&quot;Types de voie&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot-voie5"></span>
<img src="Cours_SpatialR_files/figure-html/plot-voie5-1.svg" alt="Types de voie cyclable sur l'île de Montréal" width="720" />
<p class="caption">
Figure 3.7: Types de voie cyclable sur l’île de Montréal
</p>
</div>
<p>La fonction <code>aes</code> décrit quelles variables dans les données (<code>data</code>) sont illustrées (dans notre exemple, ce sont <code>TYPE_VOIE</code>) et par quelles
caractéristiques visuelles<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>. On nomme ces caractéristiques visuelles les “esthétiques” (<code>aes</code> pour “aesthetic” en anglais). Dans le présent exemple, nous nous préoccupons seulement de la couleur des données vectorielles, mais nous aurions pu aussi changer leur taille, le type de lignes, ou la forme des symboles (si la géométrie des données étaient de type point).</p>
<p>La fonction <code>scale_color_manual</code> permet de spécifier nos propres couleurs, sans quoi ce seront les couleurs par défaut qui seront utilisées<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>.</p>
<p>Finalement, la fonction <code>labs</code> permet d’assigner un titre à la légende, sans quoi c’est le nom de la variable, telle que nous l’avons définie dans <code>R</code> qui sera affichée, ici, <code>TYPE_VOIE</code>.</p>
<p>Nous pouvons aussi demander à <code>ggplot</code> de représenter les types de voie cyclable en utilisant différentes tailles de trait. De la même façon que précédemment, nous créons un vecteur de six tailles.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="leçon-2.html#cb47-1"></a>tailles_voie&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">1.5</span>,<span class="fl">1.7</span>,<span class="dv">2</span>,<span class="fl">2.2</span>)</span></code></pre></div>
<p>Puis représentatons les types de voie cyclable (Fig <a href="leçon-2.html#fig:plot-voie7">3.8</a>).</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="leçon-2.html#cb48-1"></a><span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb48-2"><a href="leçon-2.html#cb48-2"></a><span class="st">  </span><span class="co"># geom_sf(data = pistes_cyclables,  aes(color = TYPE_VOIE, size = TYPE_VOIE))+</span></span>
<span id="cb48-3"><a href="leçon-2.html#cb48-3"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> couleurs_voie)<span class="op">+</span></span>
<span id="cb48-4"><a href="leçon-2.html#cb48-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">color =</span> <span class="st">&#39;Types de voie&#39;</span>)<span class="op">+</span></span>
<span id="cb48-5"><a href="leçon-2.html#cb48-5"></a><span class="st">  </span><span class="kw">scale_size_manual</span>(<span class="dt">values =</span> tailles_voie)<span class="op">+</span></span>
<span id="cb48-6"><a href="leçon-2.html#cb48-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">size =</span> <span class="st">&#39;Types de voie&#39;</span>)<span class="op">+</span></span>
<span id="cb48-7"><a href="leçon-2.html#cb48-7"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Pistes cyclables sur l&#39;île de Montréal&quot;</span>, <span class="dt">subtitle =</span> <span class="st">&quot;Types de voie&quot;</span>)<span class="op">+</span></span>
<span id="cb48-8"><a href="leçon-2.html#cb48-8"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot-voie7"></span>
<img src="Cours_SpatialR_files/figure-html/plot-voie7-1.svg" alt="Types de voie cyclable sur l'île de Montréal (couleur et taille des traits)" width="720" />
<p class="caption">
Figure 3.8: Types de voie cyclable sur l’île de Montréal (couleur et taille des traits)
</p>
</div>
<p>La légende tient compte à la fois de la couleur, et de la taille des traits. De plus, nous l’avons affichée au bas de la figure.</p>
</div>
<div id="visualiser-plusieurs-shapefiles" class="section level4 unnumbered">
<h4>Visualiser plusieurs shapefiles</h4>
<p>Nous allons maintenant représenter les données vectorielles <code>limites terrestres</code>, <code>pistes_cyclables</code> et <code>accidents_velo</code> au sein d’une même figure. Il s’agit d’utiliser la fonction <code>geom_sf</code> pour chaque couche de données et de les combiner en utilisant le <code>+</code>.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="leçon-2.html#cb49-1"></a><span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb49-2"><a href="leçon-2.html#cb49-2"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> limites_terrestres, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>)<span class="op">+</span></span>
<span id="cb49-3"><a href="leçon-2.html#cb49-3"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> pistes_cyclables, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;darkgreen&quot;</span>)<span class="op">+</span></span>
<span id="cb49-4"><a href="leçon-2.html#cb49-4"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> accidents_velo, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">cex =</span> <span class="fl">1.25</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)<span class="op">+</span></span>
<span id="cb49-5"><a href="leçon-2.html#cb49-5"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Pistes cyclables sur l&#39;île de Montréal et Accidents routiers impliquant des vélos&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot-all1"></span>
<img src="Cours_SpatialR_files/figure-html/plot-all1-1.svg" alt="Pistes cyclables et position des accidents routiers impliquant des bicyclettes sur l'île de Montréal" width="720" />
<p class="caption">
Figure 3.9: Pistes cyclables et position des accidents routiers impliquant des bicyclettes sur l’île de Montréal
</p>
</div>
<p>Nous pouvons créer une carte plus précise qui spécifie les types de voie cyclable et ajouter une légende.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="leçon-2.html#cb50-1"></a><span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb50-2"><a href="leçon-2.html#cb50-2"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> limites_terrestres, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>)<span class="op">+</span></span>
<span id="cb50-3"><a href="leçon-2.html#cb50-3"></a><span class="st">  </span><span class="co"># geom_sf(data = pistes_cyclables, size = 1.5, aes(color = TYPE_VOIE),  show.legend = &quot;line&quot;)+</span></span>
<span id="cb50-4"><a href="leçon-2.html#cb50-4"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> couleurs_voie,<span class="dt">name =</span> <span class="st">&quot;Types de voie&quot;</span>)<span class="op">+</span></span>
<span id="cb50-5"><a href="leçon-2.html#cb50-5"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> accidents_velo, <span class="dt">pch =</span> <span class="dv">24</span>, <span class="dt">cex =</span> <span class="dv">2</span>, <span class="dt">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)<span class="op">+</span></span>
<span id="cb50-6"><a href="leçon-2.html#cb50-6"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Types de voie cyclable et Accidents routiers impliquant des vélos&quot;</span>)<span class="op">+</span></span>
<span id="cb50-7"><a href="leçon-2.html#cb50-7"></a><span class="kw">theme</span>(</span>
<span id="cb50-8"><a href="leçon-2.html#cb50-8"></a>      <span class="co">#Caractéristiques de la figure elle-même</span></span>
<span id="cb50-9"><a href="leçon-2.html#cb50-9"></a>      <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>), <span class="co">#le dessous de la carte</span></span>
<span id="cb50-10"><a href="leçon-2.html#cb50-10"></a>      <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>),  <span class="co">#le contour de la carte</span></span>
<span id="cb50-11"><a href="leçon-2.html#cb50-11"></a>      <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),              <span class="co">#retirer la grille cartésienne</span></span>
<span id="cb50-12"><a href="leçon-2.html#cb50-12"></a>      <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>(),                    <span class="co">#retirer les traits sur les axes</span></span>
<span id="cb50-13"><a href="leçon-2.html#cb50-13"></a>      <span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>(),                   <span class="co">#retirer les traits les noms ou les numéros de ces traits</span></span>
<span id="cb50-14"><a href="leçon-2.html#cb50-14"></a>      <span class="dt">axis.text.y =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb50-15"><a href="leçon-2.html#cb50-15"></a>      <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">16</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>), <span class="co">#Centrer le titre de la carte</span></span>
<span id="cb50-16"><a href="leçon-2.html#cb50-16"></a>      <span class="co">#Caractéristiques de la légende</span></span>
<span id="cb50-17"><a href="leçon-2.html#cb50-17"></a>      <span class="dt">legend.position =</span> <span class="st">&quot;top&quot;</span>,                         <span class="co">#position de la légende</span></span>
<span id="cb50-18"><a href="leçon-2.html#cb50-18"></a>      <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">colour=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="co">#titre de la légende</span></span>
<span id="cb50-19"><a href="leçon-2.html#cb50-19"></a>      <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;italic&quot;</span>),               <span class="co">#texte des éléments de la légende</span></span>
<span id="cb50-20"><a href="leçon-2.html#cb50-20"></a>      <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>), <span class="co">#rectangle autour de la légende</span></span>
<span id="cb50-21"><a href="leçon-2.html#cb50-21"></a>      <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>)        <span class="co">#couleur blanche sous les éléments de la légende</span></span>
<span id="cb50-22"><a href="leçon-2.html#cb50-22"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot-all2"></span>
<img src="Cours_SpatialR_files/figure-html/plot-all2-1.svg" alt="Types de voie cyclable et position des accidents routiers impliquant des bicyclettes sur l'île de Montréal" width="720" />
<p class="caption">
Figure 3.10: Types de voie cyclable et position des accidents routiers impliquant des bicyclettes sur l’île de Montréal
</p>
</div>
<p>La fonction <code>theme()</code> permet de d’ajuster l’apparence de la carte (couleur du fond, couleur, taille et position du titre, format de la légende, etc.). Le chapitre <a href="https://ggplot2.tidyverse.org/reference/theme.html">Modify components of theme</a> <span class="citation">(Wickham <a href="#ref-Wickham_ggplot2_2016" role="doc-biblioref">2016</a>)</span> énumère l’ensemble des paramètres pouvant être modifiés pour changer l’apparence d’une carte.</p>
</div>
</div>
<div id="reprojection-de-données-vectorielles-sous-r" class="section level3">
<h3><span class="header-section-number">3.1.3</span> Reprojection de données vectorielles sous R</h3>
<p>Dans cette section nous apprendrons à manipuler le système de coordonnées de référence de données vectorielles. Nous avons vu en début de leçon que les données utilisées sont dans la projection de Mercator transverse (<code>tmerc</code>) et utilisent le Système de référence géodésique nord-américan de 1983 (<code>NAD83</code>). Par exemple, pour connaître le SCR des données <code>limites_terrestres</code> nous avions fait.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="leçon-2.html#cb51-1"></a><span class="kw">st_crs</span>(limites_terrestres)</span></code></pre></div>
<pre><code>Coordinate Reference System:
  EPSG: 4326 
  proj4string: &quot;+proj=longlat +datum=WGS84 +no_defs&quot;</code></pre>
<p>Nous allons maintenant transformer le SCR vers la projection de Robinson (<code>robin</code>) et le Système géodésique mondial de 1984 (<code>WGS84</code>). Pour se faire nous utilisons la fonction <code>st_transform</code> de la librarie <code>st</code>.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="leçon-2.html#cb53-1"></a>limites_terrestres_rob &lt;-<span class="st"> </span><span class="kw">st_transform</span>(limites_terrestres,</span>
<span id="cb53-2"><a href="leçon-2.html#cb53-2"></a>    <span class="kw">CRS</span>(<span class="st">&quot;+proj=robin +datum=WGS84&quot;</span>))</span></code></pre></div>
<p>Comparons les données transformées avec les données initiales. Pour se faire, nous voulons représenter les deux cartes une au-dessous de l’autre. La librarie <code>ggpubr</code> permet de créer facilement des figures avec des panneaux multiples. Installez la librarie si ce n’est pas déjà fait, et chargez-là dans votre session de travail.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="leçon-2.html#cb54-1"></a><span class="kw">library</span>(ggpubr)</span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="leçon-2.html#cb55-1"></a>carte1&lt;-<span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb55-2"><a href="leçon-2.html#cb55-2"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> limites_terrestres, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb55-3"><a href="leçon-2.html#cb55-3"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Projection Mercator&quot;</span>)</span>
<span id="cb55-4"><a href="leçon-2.html#cb55-4"></a>carte2&lt;-<span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb55-5"><a href="leçon-2.html#cb55-5"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> limites_terrestres_rob, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;yellow&quot;</span>) <span class="op">+</span></span>
<span id="cb55-6"><a href="leçon-2.html#cb55-6"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Projection Robinson&quot;</span>)</span>
<span id="cb55-7"><a href="leçon-2.html#cb55-7"></a>figure &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(carte1, carte2, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>),<span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb55-8"><a href="leçon-2.html#cb55-8"></a>figure</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot-terre2"></span>
<img src="Cours_SpatialR_files/figure-html/plot-terre2-1.svg" alt="Limites terrestres de l'île de Montréal selon les projections Mercartor (A) et Robinson (B)" width="720" />
<p class="caption">
Figure 3.11: Limites terrestres de l’île de Montréal selon les projections Mercartor (A) et Robinson (B)
</p>
</div>
<p>Finalement, pour sauvegarder des données vectorielles, nous utilisons la fonction <code>st_write</code> de la librarie <code>st</code>, de la même façon que nous avons utilisé la fonction <code>st_read</code> en début de leçon. Par exemple, sauvons les données <code>limites_terrestres_rob</code> que nous venons de créer.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="leçon-2.html#cb56-1"></a>chemin&lt;-<span class="st">&quot;D:/votrechemin/SCI1031/Module3/Donnees/&quot;</span></span>
<span id="cb56-2"><a href="leçon-2.html#cb56-2"></a>nom_du_fichier&lt;-<span class="st"> </span><span class="kw">paste</span>(chemin, <span class="st">&quot;/Montreal_Velo/terre/terre_rob_shp.shp&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb56-3"><a href="leçon-2.html#cb56-3"></a><span class="kw">st_read</span>(limites_terrestres_rob,nom_du_fichier)</span></code></pre></div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Wickham_ggplot2_2016">
<p>Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Wasser, L. A., Jones, M. A., Brum, Z., Riemer, K., Williams, J., Hollister, J., . . . Stachelek, J. Introduction to Geospatial Raster and Vector Data with R. Repéré le 1er mars 2020 à <a href="https://datacarpentry.org/r-raster-vector-geospatial/" class="uri">https://datacarpentry.org/r-raster-vector-geospatial/</a><a href="leçon-2.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Pour plus d’information sur la fonction <code>geom_sf</code>, consultez le chapitre <a href="https://ggplot2.tidyverse.org/reference/ggsf.html">Visualise sf objects</a> <span class="citation">(Wickham <a href="#ref-Wickham_ggplot2_2016" role="doc-biblioref">2016</a>)</span><a href="leçon-2.html#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Ville de Montréal. Aménagements cyclables. Repéré le 19 mars 2020<a href="leçon-2.html#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>Pour plus d’information sur la fonction <code>aes</code>, consultez le chapitre <a href="https://ggplot2.tidyverse.org/reference/aes.html">Construct aesthetic mappings</a> <span class="citation">(Wickham <a href="#ref-Wickham_ggplot2_2016" role="doc-biblioref">2016</a>)</span><a href="leçon-2.html#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>Pour plus d’information sur la fonction <code>scale_colour_manual</code>, consultez le chapitre <a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">Create your own discrete scale</a> <span class="citation">(Wickham <a href="#ref-Wickham_ggplot2_2016" role="doc-biblioref">2016</a>)</span><a href="leçon-2.html#fnref5" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="vec.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exercice-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Cours_SpatialR.pdf", "pdf"]],
"toc": {
"collapse": "subsection",
"scroll_highlight": true,
"edit": "https://github.com/McCannLab/TheoryClub/edit/master/%s"
}
});
});
</script>

</body>

</html>
